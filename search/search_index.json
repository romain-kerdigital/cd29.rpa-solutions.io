{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Documentation CD29","text":"<p>Documentation CD29</p>"},{"location":"SAFI/A_Initialisation/","title":"A_Initialisation","text":""},{"location":"SAFI/A_Initialisation/#reprise-des-marches-safi-a_initialisation","title":"Reprise des march\u00e9s SAFI - A_Initialisation","text":""},{"location":"SAFI/A_Initialisation/#fermer-les-applications","title":"Fermer les applications","text":""},{"location":"SAFI/A_Initialisation/#lire-les-donnees-dans-le-fichier-excel","title":"Lire les donn\u00e9es dans le fichier Excel","text":"<p> Les donn\u00e9es sont stock\u00e9es dans ExcelData. Pour y acc\u00e9der, il faut ajouter des crochets : ExcelData[x][y] O\u00f9 \"x\" correspond \u00e0 la ligne et \"y\" correspond \u00e0 la colonne.</p> <p>Le tableau comporte une ligne d'en-t\u00eate, donc la premi\u00e8re ligne de donn\u00e9es est la ligne num\u00e9ro 2 sur Excel. Dans ExcelData, elle correspond \u00e0 x=0. x correspond donc au num\u00e9ro de la ligne Excel moins 2.</p> <p>Pour y, plut\u00f4t que de raisonner par lettres pour les colonnes. On peut utiliser directement le titre de la colonne entre apostrophes. Les colonnes peuvent ainsi \u00eatre d\u00e9plac\u00e9es sans probl\u00e8mes.</p> <p>Warning</p> <p>Penser \u00e0 bien mettre \u00e0 jour la colonne de fin lorsque de nouvelles colonnes sont ajout\u00e9es \u00e0 l'\u00e9tape de lecture des donn\u00e9es du fichier Excel.</p>"},{"location":"SAFI/A_Initialisation/#se-connecter-a-grand-angle","title":"Se connecter \u00e0 Grand Angle","text":"<p> On allume Microsoft Edge sur la page de connexion.</p> <p>Il peut arriver (surtout lors des tests) que l'on soit d\u00e9j\u00e0 connect\u00e9s afin de poursuivre l'automatisation m\u00eame dans un statut connect\u00e9, on v\u00e9rifie l'URL. Si on est sur la page de connexion, l'URL de la page se termine par \"login\" on remplit alors les informations de connexion. Si on est redirig\u00e9 automatiquement sur le tableau de bord, l'URL change et ne se termine plus par \"login\". Les \u00e9tapes sont ignor\u00e9es.</p> <p>Lors de la connexion, un bandeau s'affiche pour accepter les cookies. Pour le masquer, on ajoute ce script :</p>"},{"location":"SAFI/A_Initialisation/#enlever-le-bandeau","title":"Enlever le bandeau","text":"<pre><code>// Enlever bandeau\ndocument.cookie = \"rgpdInfosHidden=1; path=/;\";\ndocument.getElementsByClassName(\"mat-snack-bar-container\")[0].style.display = \"none\";\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/","title":"B_CreationNouveauMarche","text":""},{"location":"SAFI/B_CreationNouveauMarche/#reprise-des-marches-safi-b_creationnouveaumarche","title":"Reprise des march\u00e9s SAFI - B_CreationNouveauMarche","text":""},{"location":"SAFI/B_CreationNouveauMarche/#cliquer-sur-creer-un-nouveau-marche-et-remplir-les-premieres-informations","title":"Cliquer sur cr\u00e9er un nouveau march\u00e9 et remplir les premi\u00e8res informations","text":""},{"location":"SAFI/B_CreationNouveauMarche/#cliquer-sur-les-elements-du-menu","title":"Cliquer sur les \u00e9l\u00e9ments du menu","text":"<pre><code>//Cliquer sur les elements du menu\ndocument.getElementsByClassName(\"bouton-menu\")[0].click()\ndocument.getElementsByClassName(\"mat-focus-indicator bandeau__button mat-button mat-button-base ng-star-inserted\")[3].click()\ndocument.getElementsByClassName('menu ng-star-inserted')[0].click()\ndocument.getElementsByClassName('gda_bouton NouveauImg gda_bouton_actif')[0].click()\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#remplir-la-premiere-page","title":"Remplir la premi\u00e8re page","text":"<pre><code>//Remplir les informations sur le march\u00e9\ndocument.getElementsByName('marche_miAnnee')[0].value=\"%ExcelData[LoopIndex]['Num\u00e9ro de march\u00e9 - Ann\u00e9e AAAA']%\";\ndocument.getElementsByName('marche_msNumero')[0].value=\"%ExcelData[LoopIndex]['Num\u00e9ro de march\u00e9 - Code']%\";\ndocument.getElementsByName('marche_msObjet')[0].value=\"%ExcelData[LoopIndex]['Objet']%\";\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#cliquer-sur-suivant","title":"Cliquer sur Suivant","text":"<p>On lance le javascript associ\u00e9 au bouton Suivant.</p> <pre><code>effectuerSuivante()\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#remplir-la-duree","title":"Remplir la dur\u00e9e","text":"<pre><code>// Duree\ndocument.getElementsByName('marcheDuree_miAnnees')[0].value=\"%ExcelData[LoopIndex]['Dur\u00e9e du march\u00e9 - Ann\u00e9es']%\";\ndocument.getElementsByName('marcheDuree_miMois')[0].value=\"%ExcelData[LoopIndex]['Dur\u00e9e du march\u00e9 - Mois']%\";\ndocument.getElementsByName('marcheDuree_miJours')[0].value=\"%ExcelData[LoopIndex]['Dur\u00e9e du march\u00e9 - Jours']%\";\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#ajouter-un-type-dengagement","title":"Ajouter un type d'engagement","text":""},{"location":"SAFI/B_CreationNouveauMarche/#cliquer-sur-la-loupe-type-dengagement","title":"Cliquer sur la loupe Type d'engagement","text":"<p>Plut\u00f4t que de cliquer sur la loupe directement, on lance le javascript associ\u00e9.</p> <pre><code>// Cliquer sur la loupe Type d'engagement\nsaisieAssisteeTypeEnga()\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#attacher-la-nouvelle-fenetre-de-navigateur","title":"Attacher la nouvelle fen\u00eatre de navigateur","text":""},{"location":"SAFI/B_CreationNouveauMarche/#remplir-la-code-a-rechercher","title":"Remplir la code \u00e0 rechercher","text":"<pre><code>document.getElementsByName('typejCode')[0].value=\"%ExcelData[LoopIndex]['Type d\\'engagement - Code']%\";\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#cliquer-sur-le-bouton-rechercher","title":"Cliquer sur le bouton Rechercher","text":"<p>On lance le script associ\u00e9 au bouton Rechercher </p><pre><code>rch_jsp_BoutonRechercher()\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#cliquer-sur-le-premier-element-de-la-liste","title":"Cliquer sur le premier \u00e9l\u00e9ment de la liste","text":"<p>Ici, il n'y a pas de Name ou d'ID pour choisir l'\u00e9l\u00e9ment \u00e0 cliquer. On fait donc une recherche par TagName. Il s'agit du 5\u00e8me \u00e9l\u00e9ment de la liste des \"a\" sur la page. </p><pre><code>document.getElementsByTagName('a')[4].click()\n</code></pre> <p>Note</p> <p>Pour d\u00e9duire la recherche par TagName \u00e0 utiliser. Dans l'inspecteur il faut regarder le type d'\u00e9l\u00e9ment. Ici il s'agit d'un lien \"a\". On recherche ensuite par it\u00e9ration avec la console jusqu'\u00e0 ce que notre \u00e9l\u00e9ment soit s\u00e9lectionn\u00e9: </p><pre><code>  document.getElementsByTagName('a')[0]\n  document.getElementsByTagName('a')[1]\n  document.getElementsByTagName('a')[2]\n  document.getElementsByTagName('a')[3]\n  document.getElementsByTagName('a')[4]\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#remplir-la-forme-le-type-de-prix-et-leur-date-detablissement","title":"Remplir la forme, le type de prix et leur date d'\u00e9tablissement","text":""},{"location":"SAFI/B_CreationNouveauMarche/#forme-de-prix","title":"Forme de prix","text":"<p>Il s'agit d'un menu d\u00e9roulant, mais on peut valoriser la valeur comme un champ de texte. </p><pre><code>// Forme de prix\ndocument.getElementsByName('formePrix_miCode')[0].value=\"%ExcelData[LoopIndex]['Forme de prix - Code']%\";\n</code></pre> <p>Note</p> <p>Pour simplifier l'automatisation, tous les choix possibles sont rassembl\u00e9s dans la feuille \"Listes\" sur Excel avec la correspondance avec le code sur Grand Angle. Une colonne a ensuite \u00e9t\u00e9 ajout\u00e9e sur la feuille principale en utilisant RECHERCHEV() qui affiche directement le code qui correspond \u00e0 l'option \u00e0 s\u00e9lectionner.</p>"},{"location":"SAFI/B_CreationNouveauMarche/#type-de-prix","title":"Type de prix","text":"<p>Il s'agit d'un bouton radio, mais on peut valoriser la valeur comme un champ de texte. </p><pre><code>// Type de prix\ndocument.getElementsByName('typePrix_miCode')[0].value=\"%ExcelData[LoopIndex]['Type de prix - Code']%\";\n</code></pre> <p>Apr\u00e8s avoir s\u00e9lectionn\u00e9 le type de prix, de nouvelles cases s'affichent si le type de prix n'est pas ferme.</p> <p></p>"},{"location":"SAFI/B_CreationNouveauMarche/#type-de-prix-revisables-ou-fermes-actualisables","title":"Type de prix \"R\u00e9visables\" ou \"Fermes actualisables\"","text":"<p>On coche le type d'index </p><pre><code>// Cocher index\ndocument.getElementById(%ExcelData[LoopIndex]['Type de prix - Index - Code']%).checked=true\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#type-de-prix-fermes-actualisables","title":"Type de prix \"Fermes actualisables\"","text":"<p>On d\u00e9finit la date d'actualisation des prix </p><pre><code>// Date d'actualisatiom\ndocument.getElementsByName('marche_mdtDatePrix')[0].value='%ExcelData[LoopIndex]['Date d\\'actualisation des prix']%'\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#type-de-prix-revisables","title":"Type de prix \"R\u00e9visables\"","text":"<p>On d\u00e9finit la p\u00e9riodicit\u00e9 de r\u00e9vision </p><pre><code>// Periodicite de revision\ndocument.getElementById('indexID').checked=true\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#si-sur-index-definitif-sans-revision-provisoire","title":"Si \"sur index d\u00e9finitif sans r\u00e9vision provisoire\"","text":"<p>On renseigne le \"d\u00e9calage de lecture\" qui correspond \u00e0 un nombre de mois. </p><pre><code>// Nombre de mois\ndocument.getElementById('indexID').checked=true\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#date-detablissement-des-prix","title":"Date d'\u00e9tablissement des prix","text":"<p>On renseigne ensuite la date d'\u00e9tablissement des prix. </p><pre><code>// Date d'etablissement des prix\ndocument.getElementsByName('marche_mdtDatePrix')[0].value=\"%ExcelData[LoopIndex]['Date d\\'\u00e9tablissement des prix']%\";\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#choisir-le-code-cpv","title":"Choisir le Code CPV","text":""},{"location":"SAFI/B_CreationNouveauMarche/#cliquer-sur-la-loupe","title":"Cliquer sur la loupe","text":"<pre><code>// Code CPV principal\nsaisieAssisteeCodeCpv();\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#attacher-le-navigateur","title":"Attacher le navigateur","text":"<p>http://garec.cg29.local/intranet/glob/sass/ChargerRechercherCodeCPVPopup.gda</p>"},{"location":"SAFI/B_CreationNouveauMarche/#recuperer-premier-resultat","title":"R\u00e9cup\u00e9rer premier r\u00e9sultat","text":"<pre><code>// Code CPV - Recuperer premier resultat\nstr = document.getElementsByTagName('a')[1].getAttribute('href').replaceAll('\\t','').replaceAll('\\n','').replace('javascript:','').replace('; return false;','');\nsetTimeout(str,1);\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#remplir-les-montants","title":"Remplir les Montants","text":""},{"location":"SAFI/B_CreationNouveauMarche/#remplir-montant-initial-ht","title":"Remplir Montant initial HT","text":"<pre><code>// Montant initial HT\ndocument.getElementsByName('marche_mdInitHT')[0].value=%ExcelData[LoopIndex]['Montant initial HT']%;\ndocument.getElementsByName('marche_mdInitHT')[0].onfocus();\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#remplir-taux-de-tva","title":"Remplir Taux de TVA","text":"<pre><code>// TVA\ndocument.getElementsByName('marcheTva_MiCode')[0].value=%ExcelData[LoopIndex]['Taux de TVA - Code']%;\ndocument.getElementsByName('marcheTva_MiCode')[0].onchange();\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#si-le-taux-de-tva-est-multi-taux-remplir-montant-initial-ttc","title":"Si le taux de TVA est \"multi-taux\" : Remplir Montant initial TTC","text":"<pre><code>// Montant initial TTC\ndocument.getElementsByName('marche_mdInitTTC')[0].value=\"%ExcelData[LoopIndex]['Montant initial TTC']%\";\ndocument.getElementsByName('marche_mdInitTTC')[0].onchange();\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#page-suivante","title":"Page suivante","text":"<pre><code>// Page suivante\neffectuerSuivante()\n</code></pre> <p>Warning</p> <p>Une erreur s'affiche. Malgr\u00e9 plusieurs tentatives, impossible de s'en d\u00e9barasser. Elle n'est pas bloquante. Il suffit de cliquer une deuxi\u00e8me fois sur \"Suivant\"</p> <pre><code>// Page suivante\neffectuerSuivante()\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#remplir-mode-de-passation-devolution-et-la-gestion-de-la-retenue-de-garantie","title":"Remplir Mode de passation, d\u00e9volution et la gestion de la retenue de garantie","text":""},{"location":"SAFI/B_CreationNouveauMarche/#remplir-le-mode-de-passation","title":"Remplir le mode de passation","text":"<pre><code>// Mode de passation\ndocument.getElementsByName('modePassation_miCode')[0].value=\"%ExcelData[LoopIndex]['Mode de passation - Code']%\";\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#remplir-la-devolution","title":"Remplir la d\u00e9volution","text":"<pre><code>// Devolution\ndocument.getElementsByName('modeDevolution_miCode')[0].value=\"%ExcelData[LoopIndex]['D\u00e9volution - Code']%\";\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#remplir-la-gestion-de-la-retenue-de-garantie","title":"Remplir la gestion de la retenue de garantie","text":"<pre><code>// Gestion de la retenue de garantie\ndocument.getElementsByName('marche_retenue_garantie_miCode')[0].value=\"%ExcelData[LoopIndex]['Gestion de la retenue de garantie - Code']%\";\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#definir-lauto-liquidation-de-la-sous-traitance","title":"D\u00e9finir l'auto-liquidation de la sous-traitance","text":"<p>Si Auto-liquidation de la sous-traitance est \u00e0 \"Oui\", on coche la case.</p> <pre><code>// Cocher auto-liquidation de la TVA\ndocument.getElementsByName('marche_mbAutoLiqTvaSousTraitant')[0].checked=true\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#si-reconduction-remplir-les-informations-associees","title":"Si Reconduction, remplir les informations associ\u00e9es","text":""},{"location":"SAFI/B_CreationNouveauMarche/#cocher-expresse-ou-tacite","title":"Cocher Expresse ou Tacite","text":"<pre><code>// Cocher Expresse ou Tacite\ndocument.getElementsByName('%ExcelData[LoopIndex]['Reconduction - Code']%')[0].click()\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#remplir-les-3-cases-de-duree-de-reconduction","title":"Remplir les 3 cases de dur\u00e9e de reconduction","text":"<pre><code>// Duree de reconduction\ndocument.getElementsByName('marche_miAnneeReconduction')[0].value=\"%ExcelData[LoopIndex]['Dur\u00e9e de reconduction - Ann\u00e9es']%\";\ndocument.getElementsByName('marche_miMoisReconduction')[0].value=\"%ExcelData[LoopIndex]['Dur\u00e9e de reconduction - Mois']%\";\ndocument.getElementsByName('marche_miJourReconduction')[0].value=\"%ExcelData[LoopIndex]['Dur\u00e9e de reconduction - Jours']%\";\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#valoriser-le-nombre-de-reconduction","title":"Valoriser le nombre de reconduction","text":"<pre><code>// Nombre de reconduction\ndocument.getElementsByName('marche_miNbReconduction')[0].value=\"%ExcelData[LoopIndex]['Nombre de reconductions']%\";\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#definir-les-dates-de-consultation-de-signature","title":"D\u00e9finir les dates de consultation, de signature","text":""},{"location":"SAFI/B_CreationNouveauMarche/#valoriser-la-date-de-consultation","title":"Valoriser la date de consultation","text":"<pre><code>// Date de consultation\ndocument.getElementsByName('marche_mdtConsultation')[0].value=\"%ExcelData[LoopIndex]['Date de consultation']%\";\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#valoriser-la-date-de-signature","title":"Valoriser la date de signature","text":"<pre><code>// Date de signature\ndocument.getElementsByName('marche_mdtSignature')[0].value=\"%ExcelData[LoopIndex]['Date de signature']%\";\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#delai-de-liquidation-et-fin-du-flux","title":"D\u00e9lai de liquidation et fin du flux","text":""},{"location":"SAFI/B_CreationNouveauMarche/#valoriser-le-delai-de-liquidation-a-1460-jours","title":"Valoriser le d\u00e9lai de liquidation \u00e0 1460 jours","text":"<pre><code>// Delai de liquidation\ndocument.getElementsByName('')[0].value=\"1460\";\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#cliquer-sur-suivant_1","title":"Cliquer sur Suivant","text":"<pre><code>// Page suivante\neffectuerSuivante()\n</code></pre>"},{"location":"SAFI/B_CreationNouveauMarche/#cliquer-sur-valider","title":"Cliquer sur Valider","text":"<pre><code>Valider()\n</code></pre>"},{"location":"SAFI/C_CreationContractant/","title":"C_CreationContractant","text":""},{"location":"SAFI/C_CreationContractant/#reprise-des-marches-safi-c_creationcontractant","title":"Reprise des march\u00e9s SAFI - C_CreationContractant","text":""},{"location":"SAFI/C_CreationContractant/#cliquer-sur-les-boutons","title":"Cliquer sur les boutons","text":"<p>Cliquer sur l'onglet \"D\u00e9tails\" </p><pre><code>//Cliquer sur l'onglet d\u00e9tails\nChangerOnglet(2);\n</code></pre> <p>Cliquer sur \"Cr\u00e9er un contractant\" </p><pre><code>// Cr\u00e9er un contractant\nchargerPage('../../intranet/marc/CreerContractant.gda', event)\n</code></pre> <p>Etant donn\u00e9 qu'il y a le num\u00e9ro du contractant variable dans le nom de colonne, par pr\u00e9caution, on assigne une nouvelle variable : \"Colonne Contractant\" qui contient le num\u00e9ro dynamique du contractant : </p>"},{"location":"SAFI/C_CreationContractant/#pointer-sur-la-colonne-tiers-code","title":"Pointer sur la colonne \"Tiers - Code\"","text":"<pre><code>Contractant %LoopIndexContractant% - Tiers - Code\n</code></pre>"},{"location":"SAFI/C_CreationContractant/#identification-du-contractant","title":"Identification du Contractant","text":""},{"location":"SAFI/C_CreationContractant/#remplir-le-code-tiers","title":"Remplir le Code Tiers","text":"<pre><code>// Remplir le Code Tiers\ndocument.getElementsByName('contractantTiers_miCode')[0].value=\"%ExcelData[LoopIndex][ColonneContractant]%\";\n</code></pre> Apr\u00e8s avoir saisi le code Tiers, il faut lancer les scripts qui se chargent habituellement lors du changement dans la case. <pre><code>lancerAllerRetourRPCTiers(document.forms[0], 'contractantTiers_miCode', 'contractantTiers_msLib', 'contractantRefBancaire_miCode', 'contractantRefBancaire_msLib', 'contractantTiers_miCode', null, 'callbackRetourARTiers','contracantRefBancaireTiers_miCode','contracantRefBancaireTiers_msLibelle','provenance');\n</code></pre>"},{"location":"SAFI/C_CreationContractant/#remplir-le-role-du-contractant","title":"Remplir le r\u00f4le du Contractant","text":"<p>Le r\u00f4le peut \u00eatre : Titulaire, Sous-traitant ou Mandataire</p>"},{"location":"SAFI/C_CreationContractant/#pointer-sur-la-colonne-role-code","title":"Pointer sur la colonne \"R\u00f4le - Code\"","text":"<pre><code>Variable \"Colonne Contractant\"\nContractant %LoopIndexContractant% - R\u00f4le - Code\n</code></pre> <p>La liste des r\u00f4les et leurs indexs respectifs sont renseign\u00e9s dans Excel. Il suffit d'attribuer la valeur. </p><pre><code>// Remplir le r\u00f4le\ndocument.getElementsByName('contractantRole_msIdentif')[0].value=\"%ExcelData[LoopIndex][ColonneContractant]%\";\n</code></pre>"},{"location":"SAFI/C_CreationContractant/#si-le-role-est-mandataire","title":"Si le r\u00f4le est Mandataire","text":"<p> Si le r\u00f4le est mandataire : </p><pre><code>%ExcelData[LoopIndex][ColonneContractant]% = MA\n</code></pre>"},{"location":"SAFI/C_CreationContractant/#pointer-sur-la-colonne-mandataire-designation","title":"Pointer sur la colonne \"Mandataire - D\u00e9signation\"","text":"<pre><code>Contractant %LoopIndexContractant% - Mandataire - D\u00e9signation\n</code></pre>"},{"location":"SAFI/C_CreationContractant/#remplir-designation-du-mandataire","title":"Remplir \"D\u00e9signation du mandataire\"","text":"<pre><code>// Remplir D\u00e9signation\ndocument.getElementsByName('contractantMsDesignationGroupementMandataire')[0].value=\"%ExcelData[LoopIndex][ColonneContractant]%\";\n</code></pre>"},{"location":"SAFI/C_CreationContractant/#references-bancaires","title":"R\u00e9f\u00e9rences bancaires","text":""},{"location":"SAFI/C_CreationContractant/#cliquer-sur-la-loupe-et-attacher-le-navigateur","title":"Cliquer sur la loupe et attacher le navigateur","text":"<pre><code>// Cliquer sur la loupe\nsaisieAssisteeReferenceBancaire('contractantTiers_miCode', 'contracantRefBancaireTiers_miCode', 'contractantRefBancaire_miCode', 'contractantRefBancaire_msLib');\n</code></pre> <p>Attacher le navigateur http://garec.cg29.local/intranet/glob/sass/recherchePopupRefTiers.gda</p>"},{"location":"SAFI/C_CreationContractant/#choisir-la-bonne-reference-bancaire","title":"Choisir la bonne r\u00e9f\u00e9rence bancaire","text":"<p>Note</p> <p>Plusieurs r\u00e9f\u00e9rences bancaires peuvent appara\u00eetre. Il faut choisir celle qui correspond et retourner un message d'erreur lorsque la r\u00e9f\u00e9rence bancaire n'est pas enregistr\u00e9e.</p> <p></p> <p>Note</p> <p>On r\u00e9cup\u00e8re le nombre total d'\u00e9l\u00e9ments en \"gras\". Il y a 4 \u00e9l\u00e9ments en gras par ligne, on r\u00e9cup\u00e8re le nombre d'\u00e9l\u00e9ments dans la liste des \u00e9l\u00e9ments en gras sur la fen\u00eatre. Le bouton \u00e0 cliquer est le premier \u00e9l\u00e9ment de la ligne sur un modulo 4. Le dernier \u00e9l\u00e9ment s\u00e9lectionnable est donc le dernier \u00e9l\u00e9ment moins 3. On stocke cette valeur dans une variable \"MaxIterations\"</p> <pre><code>// Obtenir le nombre de r\u00e9sultats\nnb=document.getElementsByTagName('strong').length-3;\nreturn nb;\n</code></pre> <p>Note</p> <p>Le r\u00e9sultat stock\u00e9 n'est pas automatquement reconnu en nombre. On convertit donc \"MaxIterations\" en nombre \"MaxIterationsBanque\" pour permettre des it\u00e9rations.</p> <p>On change la \"Colonne contractant\" : Contractant %LoopIndexContractant% - Iban \u00e0 cr\u00e9diter</p> <p>On lance ensuite une boucle de 0 \u00e0 MaxIt\u00e9rationsBanques avec un pas \u00e0 4 (pour chaque ligne)</p> <p>On r\u00e9cup\u00e8re la valeur de l'IBAN et on supprime les espaces, tabulations et sauts de ligne. On supprime le texte au d\u00e9but et \u00e0 la fin et on se retrouve avec l'IBAN seul.</p> <pre><code>str=document.getElementsByTagName('strong')[%LoopIndexBanque%].textContent.replaceAll('\\n','').replaceAll('\\t','').replaceAll(' ','');\nstr2=str.substring(4,31);\nreturn str2;\n</code></pre> <p></p><pre><code>ColonneContractantValeur = %ExcelData[LoopIndex][ColonneContractant]%\n</code></pre> Si IbanTest = ColonneContractantValeur On d\u00e9finit la variable : IterationFinaleBanque = %(LoopIndexBanque - 1) / 4% Et on sort de la boucle. <p>On poursuit la boucle jusqu'\u00e0 ce que la valeur corresponde</p> <p>Si on arrive au bout de MaxIterationBanques et que la valeur ne correspond pas, On d\u00e9finit la variable \"Erreur\" avec comme valeur : \"IBAN non attach\u00e9 au tiers\" Et on lance le flux G_RapportErreur avant d'arr\u00eater l'automatisation.</p> <p>Une fois sorti de la boucle, on clique sur l'\u00e9l\u00e9ment num\u00e9ro \"IterationFinaleBanque\" de la liste.</p> <pre><code>document.getElementsByTagName('a')[%IterationFinaleBanque%].click()\n</code></pre>"},{"location":"SAFI/C_CreationContractant/#montants-mecanismes-davance-et-fin-du-flux","title":"Montants, M\u00e9canismes d'avance et fin du flux","text":""},{"location":"SAFI/C_CreationContractant/#pointer-sur-la-colonne-montant-previsionnel-ht","title":"Pointer sur la colonne \"Montant pr\u00e9visionnel HT\"","text":"<pre><code>Contractant %LoopIndexContractant% - Montant pr\u00e9visionnel HT\n</code></pre> <pre><code>// Remplir Montant pr\u00e9visionnel HT\ndocument.getElementsByName('contractantMtPrevHT')[0].value=\"%ExcelData[LoopIndex][ColonneContractant]%\";\n</code></pre>"},{"location":"SAFI/C_CreationContractant/#pointer-sur-la-colonne-montant-ht","title":"Pointer sur la colonne \"Montant HT\"","text":"<pre><code>Contractant %LoopIndexContractant% - Montant HT\n</code></pre> <pre><code>// Remplir Montant HT\ndocument.getElementsByName('contractantMtHTInit')[0].value=%ExcelData[LoopIndex][ColonneContractant]%;\n</code></pre>"},{"location":"SAFI/C_CreationContractant/#pointer-sur-la-colonne-tva-code","title":"Pointer sur la colonne \"TVA - Code\"","text":"<pre><code>Contractant %LoopIndexContractant% - TVA - Code\n</code></pre> <pre><code>// Remplir TVA\ndocument.getElementsByName('contractantTva_miCode')[0].value=%ExcelData[LoopIndex][ColonneContractant]%;\ndocument.getElementsByName('contractantTva_miCode')[0].onchange();\n</code></pre>"},{"location":"SAFI/C_CreationContractant/#pointer-sur-la-colonne-avance-code","title":"Pointer sur la colonne \"Avance - Code\"","text":"<pre><code>Contractant %LoopIndexContractant% - Avance - Code\n</code></pre> <pre><code>// Remplir Avance\ndocument.getElementsByName('contractant_MecAv_miCode')[0].value=%ExcelData[LoopIndex][ColonneContractant]%;\ndocument.getElementsByName('contractant_MecAv_miCode')[0].onchange();\n</code></pre>"},{"location":"SAFI/C_CreationContractant/#pointer-sur-la-colonne-taux-davance","title":"Pointer sur la colonne \"Taux d'avance\"","text":"<pre><code>Contractant %LoopIndexContractant% - Taux d'avance\n</code></pre>"},{"location":"SAFI/C_CreationContractant/#remplir-le-taux-davance","title":"Remplir le taux d'avance","text":"<pre><code>// Remplir Taux avance\ndocument.getElementsByName('contractant_mdTaux')[0].value='%ExcelData[LoopIndex][ColonneContractant]%';\n</code></pre>"},{"location":"SAFI/C_CreationContractant/#cliquer-sur-suivant","title":"Cliquer sur Suivant","text":"<pre><code>// Page suivante\neffectuerSuivante()\n</code></pre>"},{"location":"SAFI/C_CreationContractant/#cliquer-sur-valider","title":"Cliquer sur Valider","text":"<pre><code>Valider()\n</code></pre>"},{"location":"SAFI/C_CreationContractant/#cliquer-sur-retour","title":"Cliquer sur Retour","text":"<pre><code>Retour(00, \"../../intranet/marc/AfficheMarche.gda?cas=4&amp;IDG=1&amp;IDG=1&amp;IDIP=IDIP_1670579254806&amp;code=1052&amp;ignorerIDIP=1&amp;onglet=2&amp;histoaction=-1\")\n</code></pre>"},{"location":"SAFI/D_FormulesActes/","title":"D_FormulesActes","text":""},{"location":"SAFI/D_FormulesActes/#reprise-des-marches-safi-d_formulesactes","title":"Reprise des march\u00e9s SAFI - D_FormulesActes","text":""},{"location":"SAFI/D_FormulesActes/#creer-une-formule-de-variation","title":"Cr\u00e9er une formule de variation","text":"<p>On clique d'abord sur le bouton \"Cr\u00e9er une formule de variation\" </p><pre><code>// Cr\u00e9er une formule\nchargerPage('../../intranet/marc/CreerFormuleVariation.gda')\n</code></pre> <p>Toutes les formules ont \u00e9t\u00e9 enregistr\u00e9es dans Excel avec leur index dans le menu d\u00e9roulant. Il suffit de valoriser le menu d\u00e9roulant avec l'index du fichier Excel. </p><pre><code>// Choisir une formule\ndocument.getElementsByName('typeFormuleVariation_miCode')[0].value=\"%ExcelData[LoopIndex]['Formule de variation du march\u00e9 - Code']%\";\nRemplirFormulaire()\n</code></pre> <p>On lance le javascript du bouton \"Suivant\". </p><pre><code>// Suivant\neffectuerSuivante()\n</code></pre> <p>On lance le javascript du bouton \"Valider\". </p><pre><code>// Valider\nValider()\n</code></pre> <p>On lance le javascript du bouton \"Retour\". </p><pre><code>// Retour\nRetour(00, \"../../intranet/marc/AfficheMarche.gda?cas=4&amp;IDG=1&amp;IDG=1&amp;IDIP=IDIP_1670856590548&amp;code=1078&amp;ignorerIDIP=1&amp;onglet=2&amp;histoaction=-1\")\n</code></pre>"},{"location":"SAFI/D_FormulesActes/#creer-un-acte","title":"Cr\u00e9er un acte","text":"<p>On clique sur le bouton \"Cr\u00e9er un acte\"</p> <p></p><pre><code>// Creer un acte\nchargerPage('../../intranet/marc/CreerActe.gda', event);\n</code></pre> On valorise les dates enregistr\u00e9es dans le fichier Excel. <pre><code>// Ajouter dates\ndocument.getElementsByName('acte_mdtEffet')[0].value=\"%ExcelData[LoopIndex]['Notification du march\u00e9 - Date d\\'effet']%\";\ndocument.getElementsByName('acte_mdtSignature')[0].value=\"%ExcelData[LoopIndex]['Notification du march\u00e9 - Date de signature']%\";\ndocument.getElementsByName('acte_mdtNotification')[0].value=\"%ExcelData[LoopIndex]['Notification du march\u00e9 - Date de notification']%\";\ndocument.getElementsByName('acte_mdtArrete')[0].value=\"%ExcelData[LoopIndex]['Notification du march\u00e9 - Date d\\'accus\u00e9 r\u00e9ception']%\";\n</code></pre> <p>On lance le javascript du bouton \"Suivant\". </p><pre><code>// Page suivante\neffectuerSuivante()\n</code></pre> On lance le javascript du bouton \"Valider\". <pre><code>Valider()\n</code></pre> On lance le javascript du bouton \"Retour\". <pre><code>Retour(00, \"../../intranet/marc/ChargerRechercheMarche.gda?favCode=145&amp;IDG=1&amp;ignorerIDIP=1&amp;ignorerIDIP=1&amp;onglet=2&amp;histoaction=-1\")\n</code></pre> On lance le javascript du bouton \"Retour\". (Deuxi\u00e8me fois) <pre><code>h_jsp_BoutonRetour();\n</code></pre> <p>On lance le javascript du bouton \"Retour\". (Troisi\u00e8me fois) </p><pre><code>rch_jsp_BoutonRetour();\n</code></pre>"},{"location":"SAFI/E_RapportExecution/","title":"E_RapportExecution","text":""},{"location":"SAFI/E_RapportExecution/#reprise-des-marches-safi-e_rapportexecution","title":"Reprise des march\u00e9s SAFI - E_RapportExecution","text":""},{"location":"SAFI/E_RapportExecution/#recuperer-informations","title":"R\u00e9cup\u00e9rer informations","text":"<ul> <li>Obtenir la date et l'heure</li> <li>R\u00e9cup\u00e9rer le nom de la base dans l'URL</li> </ul>"},{"location":"SAFI/E_RapportExecution/#ecrire-informations-dans-excel","title":"Ecrire informations dans Excel","text":"<ul> <li>Colonne A : Date</li> <li>Colonne B : Heure</li> <li>Colonne C : Base</li> <li>Colonne D : \"Trait\u00e9</li> </ul> <p>On arrive \u00e0 la fin de la boucle. S'il reste des lignes \u00e0 traiter, on peut continuer avec le flux B_CreationMarche.</p> <p>Si on arrive \u00e0 la derni\u00e8re ligne, on lance le flux F_Finalisation.</p>"},{"location":"SAFI/F_Finalisation/","title":"F_Finalisation","text":""},{"location":"SAFI/F_Finalisation/#reprise-des-marches-safi-f_finalisation","title":"Reprise des march\u00e9s SAFI - F_Finalisation","text":""},{"location":"SAFI/F_Finalisation/#fermeture-des-applications","title":"Fermeture des applications","text":"<ul> <li>Fermeture de l'instance Excel</li> <li>Fermeture du navigateur</li> </ul>"},{"location":"SAFI/G_RapportErreur/","title":"G_RapportErreur","text":""},{"location":"SAFI/G_RapportErreur/#reprise-des-marches-safi-g_rapporterreur","title":"Reprise des march\u00e9s SAFI - G_RapportErreur","text":""},{"location":"SAFI/G_RapportErreur/#recuperer-informations","title":"R\u00e9cup\u00e9rer informations","text":"<ul> <li>Un message d'erreur est enregistr\u00e9 au pr\u00e9alable dans la variable \"Erreur\"</li> <li>Obtenir la date et l'heure</li> <li>R\u00e9cup\u00e9rer le nom de la base dans l'URL</li> </ul>"},{"location":"SAFI/G_RapportErreur/#ecrire-informations-dans-excel","title":"Ecrire informations dans Excel","text":"<ul> <li>Colonne A : Date</li> <li>Colonne B : Heure</li> <li>Colonne C : Base</li> <li>Colonne D : \"Erreur\"</li> <li>Colonne E : D\u00e9tails de l'erreur</li> </ul>"},{"location":"SAFI/annexes/","title":"Annexes","text":""},{"location":"SAFI/annexes/#reprise-des-marches-safi-annexes","title":"Reprise des march\u00e9s SAFI - Annexes","text":""},{"location":"SAFI/annexes/#donnees-excel-projet-reprise-des-marches-safi","title":"Donn\u00e9es Excel projet Reprise des march\u00e9s SAFI","text":"Titre Description Date Date de dernier traitement Heure Heure de dernier traitement Base Base (Garec pour d\u00e9marrer) Statut A testerTest\u00e9A mettre en prodR\u00e9alis\u00e9 Commentaire RPA Commentaire sur le statut de l'automatisationErreurs rencontr\u00e9es Commentaire CD29 Commentaire sur les donn\u00e9esIndiquer les lignes \u00e0 ignorer Validation RPA Noter \"Valide\" lorsque la ligne a \u00e9t\u00e9 test\u00e9e sur la base Garec Validation CD29 Noter \"Valide\"lorsque les informations ont \u00e9t\u00e9 relues et valid\u00e9es pour cette ligne Num\u00e9ro de march\u00e9 (brut) Num\u00e9ro de march\u00e9 Num\u00e9ro de march\u00e9 - Ann\u00e9e AAAA Concat\u00e9ner \"20\" et les deux premiers caract\u00e8res du num\u00e9ro de march\u00e9 brut Num\u00e9ro de march\u00e9 - Code Les 5 derniers caract\u00e8res du num\u00e9ro de march\u00e9 brut Objet Pr\u00e9-rempli avec \"Objet - Op\u00e9ration\" \u00e0 v\u00e9rifier ou compl\u00e9ter Dur\u00e9e du march\u00e9 (brut) Dur\u00e9e du march\u00e9 Dur\u00e9e du march\u00e9 - Ann\u00e9es Division euclidienne du nombre de mois par 12 Dur\u00e9e du march\u00e9 - Mois Reste de la division euclidienne du nombre de mois par 12 Dur\u00e9e du march\u00e9 - Jours Toujours \u00e9gal \u00e0 z\u00e9ro Type d'engagement - Code Nombre entier Forme de prix Forme de prix Forme de prix - Code Mixte 3Unitaire 2Forfaitaire 1 Type de prix Type de prix Type de prix - Code Fermes 1Fermes actualisables 2R\u00e9visable 4 Type de prix - Index sur le dernier index connusur index d\u00e9finitif avec r\u00e9vision provisoiresur index d\u00e9finitif sans r\u00e9vision provisoire Type de prix - Index - Code sur le dernier index connu indexICsur index d\u00e9finitif avec r\u00e9vision provisoire indexIDsur index d\u00e9finitif sans r\u00e9vision provisoire indexSP P\u00e9riodicit\u00e9 de r\u00e9vision MensuelleAnnuelleTrimestrielleSemestrielle P\u00e9riodicit\u00e9 de r\u00e9vision - Code Mensuelle 0Annuelle 1Semestrielle 2Trimestrielle 3 Type de prix - D\u00e9calage de lecture - Nombre de mois Nombre entier de 1 \u00e0 12 Date d'actualisation des prix Date Date d'\u00e9tablissement des prix Mois M0 (date d'\u00e9tablissement des prix) Code CPV principal Pr\u00e9-rempli avec \"Code CPV principal\" \u00e0 v\u00e9rifier ou compl\u00e9ter Montant initial HT Montant intial HT Taux de TVA Pr\u00e9-rempli avec \"Taux de TVA\" \u00e0 v\u00e9rifier ou compl\u00e9ter :Multi-taux0%2,1%5,5%10%20% Taux de TVA - Code Multi-taux -10% 42,1% 35,5% 210% 1120% 10 Montant initial TTC Montant TTC Mode de passation Mode de passation Mode de passation - Code Appel d'offres ouvert 2Appel d'offres restreint 3Autre 10Concours 8Dialogue comp\u00e9titif 7March\u00e9 n\u00e9goci\u00e9 6Proc\u00e9dure adapt\u00e9e 1Proc\u00e9dure concurrentielle 4Proc\u00e9dure n\u00e9goci\u00e9e 5Syst\u00e8me d'acquisition 9 D\u00e9volution Titulaire uniqueGroupement conjointGroupement solidaireTitulaires et groupements D\u00e9volution - Code Titulaire unique 1Groupement conjoint 2Groupement solidaire 3Titulaires et groupements 4 Gestion de la retenue de garantie Gestion de la retenue de garantie Gestion de la retenue de garantie - Code Pas de retenue de garantie 0Par le payeur sans liquidation d\u00e9taill\u00e9e 2Par le payeur avec liquidation d\u00e9taill\u00e9e 3 Auto-liquidation de la sous-traitance OuiNon Reconduction Pas de reconductionExpresseTacite Reconduction - Code Pas de reconduction Pas de reconductionExpresse marche_mbReconductionTacite marche_mbReconductionTacite Dur\u00e9e de reconduction - Ann\u00e9es Nombre entier Dur\u00e9e de reconduction - Mois Nombre entier Dur\u00e9e de reconduction - Jours Nombre entier Nombre de reconductions Nombre entier Date de consultation Date de consultation Date de signature Date de signature Formule de variation du march\u00e9 (brut) Formule de variation du march\u00e9 Formule de variation du march\u00e9 Nombre entier Formule de variation du march\u00e9 - Code A faire lorsque les formules seront dans Grand Angle Notification du march\u00e9 - Date d'effet Notification du march\u00e9 - Date d'AR Notification du march\u00e9 - Date de signature Date de signature Notification du march\u00e9 - Date de notification Notification du march\u00e9 - Date Notification du march\u00e9 - Date d'accus\u00e9 r\u00e9ception Notification du march\u00e9 - Date d'AR Nombre de contractants Si le contractant N+1 est vide : NSinon N+1 Contractant 1 (brut) Contractant Contractant 1 - Tiers - Code Nombre entier Contractant 1 - R\u00f4le TitulaireSous-traitantMandataire Contractant 1 - R\u00f4le - Code A d\u00e9finir Contractant 1 - Mandataire - D\u00e9signation A remplir si le r\u00f4le du contractant est \"Mandataire\" Contractant 1 - Iban \u00e0 cr\u00e9diter Contractant - Iban \u00e0 cr\u00e9diter Contractant 1 - Montant pr\u00e9visionnel HT Nombre 2 d\u00e9cimales Contractant 1 - Montant HT Nombre 2 d\u00e9cimales Contractant 1 - TVA Multi-taux0%2,1%5,5%10%20% Contractant 1 - TVA - Code Multi-taux (Vide)0% 42,1% 35,5% 210% 1120% 10 Contractant 1 - Montant TTC Nombre 2 d\u00e9cimales Contractant 1 - Avance AucuneObligatoireFacultativeA chaque bon de commandeRefus\u00e9e Contractant 1 - Avance - Code Aucune 1Obligatoire 2Facultative 3A chaque bon de commande 4Refus\u00e9e 5 Contractant 1 - Taux d'avance Nombre 2 d\u00e9cimales Contractant 2 (brut) Contractant Contractant 2 - Tiers - Code Nombre entier Contractant 2 - R\u00f4le TitulaireSous-traitantMandataire Contractant 2 - R\u00f4le - Code A d\u00e9finir Contractant 2 - Mandataire - D\u00e9signation A remplir si le r\u00f4le du contractant est \"Mandataire\" Contractant 2 - Iban \u00e0 cr\u00e9diter Contractant - Iban \u00e0 cr\u00e9diter Contractant 2 - Montant pr\u00e9visionnel HT Nombre 2 d\u00e9cimales Contractant 2 - Montant HT Nombre 2 d\u00e9cimales Contractant 2 - TVA Multi-taux0%2,1%5,5%10%20% Contractant 2 - TVA - Code Multi-taux (Vide)0% 42,1% 35,5% 210% 1120% 10 Contractant 2 - Montant TTC Nombre 2 d\u00e9cimales Contractant 2 - Avance AucuneObligatoireFacultativeA chaque bon de commandeRefus\u00e9e Contractant 2 - Avance - Code Aucune 1Obligatoire 2Facultative 3A chaque bon de commande 4Refus\u00e9e 5 Contractant 2 - Taux d'avance Nombre 2 d\u00e9cimales Contractant 3 (brut) Contractant Contractant 3 - Tiers - Code Nombre entier Contractant 3 - R\u00f4le TitulaireSous-traitantMandataire Contractant 3 - R\u00f4le - Code A d\u00e9finir Contractant 3 - Mandataire - D\u00e9signation A remplir si le r\u00f4le du contractant est \"Mandataire\" Contractant 3 - Iban \u00e0 cr\u00e9diter Contractant - Iban \u00e0 cr\u00e9diter Contractant 3 - Montant pr\u00e9visionnel HT Nombre 2 d\u00e9cimales Contractant 3 - Montant HT Nombre 2 d\u00e9cimales Contractant 3 - TVA Multi-taux0%2,1%5,5%10%20% Contractant 3 - TVA - Code Multi-taux (Vide)0% 42,1% 35,5% 210% 1120% 10 Contractant 3 - Montant TTC Nombre 2 d\u00e9cimales Contractant 3 - Avance AucuneObligatoireFacultativeA chaque bon de commandeRefus\u00e9e Contractant 3 - Avance - Code Aucune 1Obligatoire 2Facultative 3A chaque bon de commande 4Refus\u00e9e 5 Contractant 3 - Taux d'avance Nombre 2 d\u00e9cimales Contractant 4 (brut) Contractant Contractant 4 - Tiers - Code Nombre entier Contractant 4 - R\u00f4le TitulaireSous-traitantMandataire Contractant 4 - R\u00f4le - Code A d\u00e9finir Contractant 4 - Mandataire - D\u00e9signation A remplir si le r\u00f4le du contractant est \"Mandataire\" Contractant 4 - Iban \u00e0 cr\u00e9diter Contractant - Iban \u00e0 cr\u00e9diter Contractant 4 - Montant pr\u00e9visionnel HT Nombre 2 d\u00e9cimales Contractant 4 - Montant HT Nombre 2 d\u00e9cimales Contractant 4 - TVA Multi-taux0%2,1%5,5%10%20% Contractant 4 - TVA - Code Multi-taux (Vide)0% 42,1% 35,5% 210% 1120% 10 Contractant 4 - Montant TTC Nombre 2 d\u00e9cimales Contractant 4 - Avance AucuneObligatoireFacultativeA chaque bon de commandeRefus\u00e9e Contractant 4 - Avance - Code Aucune 1Obligatoire 2Facultative 3A chaque bon de commande 4Refus\u00e9e 5 Contractant 4 - Taux d'avance Nombre 2 d\u00e9cimales Contractant 5 (brut) Contractant Contractant 5 - Tiers - Code Nombre entier Contractant 5 - R\u00f4le TitulaireSous-traitantMandataire Contractant 5 - R\u00f4le - Code A d\u00e9finir Contractant 5 - Mandataire - D\u00e9signation A remplir si le r\u00f4le du contractant est \"Mandataire\" Contractant 5 - Iban \u00e0 cr\u00e9diter Contractant - Iban \u00e0 cr\u00e9diter Contractant 5 - Montant pr\u00e9visionnel HT Nombre 2 d\u00e9cimales Contractant 5 - Montant HT Nombre 2 d\u00e9cimales Contractant 5 - TVA Multi-taux0%2,1%5,5%10%20% Contractant 5 - TVA - Code Multi-taux (Vide)0% 42,1% 35,5% 210% 1120% 10 Contractant 5 - Montant TTC Nombre 2 d\u00e9cimales Contractant 5 - Avance AucuneObligatoireFacultativeA chaque bon de commandeRefus\u00e9e Contractant 5 - Avance - Code Aucune 1Obligatoire 2Facultative 3A chaque bon de commande 4Refus\u00e9e 5 Contractant 5 - Taux d'avance Nombre 2 d\u00e9cimales Contractant 6 (brut) Contractant Contractant 6 - Tiers - Code Nombre entier Contractant 6 - R\u00f4le TitulaireSous-traitantMandataire Contractant 6 - R\u00f4le - Code A d\u00e9finir Contractant 6 - Mandataire - D\u00e9signation A remplir si le r\u00f4le du contractant est \"Mandataire\" Contractant 6 - Iban \u00e0 cr\u00e9diter Contractant - Iban \u00e0 cr\u00e9diter Contractant 6 - Montant pr\u00e9visionnel HT Nombre 2 d\u00e9cimales Contractant 6 - Montant HT Nombre 2 d\u00e9cimales Contractant 6 - TVA Multi-taux0%2,1%5,5%10%20% Contractant 6 - TVA - Code Multi-taux (Vide)0% 42,1% 35,5% 210% 1120% 10 Contractant 6 - Montant TTC Nombre 2 d\u00e9cimales Contractant 6 - Avance AucuneObligatoireFacultativeA chaque bon de commandeRefus\u00e9e Contractant 6 - Avance - Code Aucune 1Obligatoire 2Facultative 3A chaque bon de commande 4Refus\u00e9e 5 Contractant 6 - Taux d'avance Nombre 2 d\u00e9cimales Contractant 7 (brut) Contractant Contractant 7 - Tiers - Code Nombre entier Contractant 7 - R\u00f4le TitulaireSous-traitantMandataire Contractant 7 - R\u00f4le - Code A d\u00e9finir Contractant 7 - Mandataire - D\u00e9signation A remplir si le r\u00f4le du contractant est \"Mandataire\" Contractant 7 - Iban \u00e0 cr\u00e9diter Contractant - Iban \u00e0 cr\u00e9diter Contractant 7 - Montant pr\u00e9visionnel HT Nombre 2 d\u00e9cimales Contractant 7 - Montant HT Nombre 2 d\u00e9cimales Contractant 7 - TVA Multi-taux0%2,1%5,5%10%20% Contractant 7 - TVA - Code Multi-taux (Vide)0% 42,1% 35,5% 210% 1120% 10 Contractant 7 - Montant TTC Nombre 2 d\u00e9cimales Contractant 7 - Avance AucuneObligatoireFacultativeA chaque bon de commandeRefus\u00e9e Contractant 7 - Avance - Code Aucune 1Obligatoire 2Facultative 3A chaque bon de commande 4Refus\u00e9e 5 Contractant 7 - Taux d'avance Nombre 2 d\u00e9cimales Contractant 8 (brut) Contractant Contractant 8 - Tiers - Code Nombre entier Contractant 8 - R\u00f4le TitulaireSous-traitantMandataire Contractant 8 - R\u00f4le - Code A d\u00e9finir Contractant 8 - Mandataire - D\u00e9signation A remplir si le r\u00f4le du contractant est \"Mandataire\" Contractant 8 - Iban \u00e0 cr\u00e9diter Contractant - Iban \u00e0 cr\u00e9diter Contractant 8 - Montant pr\u00e9visionnel HT Nombre 2 d\u00e9cimales Contractant 8 - Montant HT Nombre 2 d\u00e9cimales Contractant 8 - TVA Multi-taux0%2,1%5,5%10%20% Contractant 8 - TVA - Code Multi-taux (Vide)0% 42,1% 35,5% 210% 1120% 10 Contractant 8 - Montant TTC Nombre 2 d\u00e9cimales Contractant 8 - Avance AucuneObligatoireFacultativeA chaque bon de commandeRefus\u00e9e Contractant 8 - Avance - Code Aucune 1Obligatoire 2Facultative 3A chaque bon de commande 4Refus\u00e9e 5 Contractant 8 - Taux d'avance Nombre 2 d\u00e9cimales Contractant 9 (brut) Contractant Contractant 9 - Tiers - Code Nombre entier Contractant 9 - R\u00f4le TitulaireSous-traitantMandataire Contractant 9 - R\u00f4le - Code A d\u00e9finir Contractant 9 - Mandataire - D\u00e9signation A remplir si le r\u00f4le du contractant est \"Mandataire\" Contractant 9 - Iban \u00e0 cr\u00e9diter Contractant - Iban \u00e0 cr\u00e9diter Contractant 9 - Montant pr\u00e9visionnel HT Nombre 2 d\u00e9cimales Contractant 9 - Montant HT Nombre 2 d\u00e9cimales Contractant 9 - TVA Multi-taux0%2,1%5,5%10%20% Contractant 9 - TVA - Code Multi-taux (Vide)0% 42,1% 35,5% 210% 1120% 10 Contractant 9 - Montant TTC Nombre 2 d\u00e9cimales Contractant 9 - Avance AucuneObligatoireFacultativeA chaque bon de commandeRefus\u00e9e Contractant 9 - Avance - Code Aucune 1Obligatoire 2Facultative 3A chaque bon de commande 4Refus\u00e9e 5 Contractant 9 - Taux d'avance Nombre 2 d\u00e9cimales Contractant 10 (brut) Contractant Contractant 10 - Tiers - Code Nombre entier Contractant 10 - R\u00f4le TitulaireSous-traitantMandataire Contractant 10 - R\u00f4le - Code A d\u00e9finir Contractant 10 - Mandataire - D\u00e9signation A remplir si le r\u00f4le du contractant est \"Mandataire\" Contractant 10 - Iban \u00e0 cr\u00e9diter Contractant - Iban \u00e0 cr\u00e9diter Contractant 10 - Montant pr\u00e9visionnel HT Nombre 2 d\u00e9cimales Contractant 10 - Montant HT Nombre 2 d\u00e9cimales Contractant 10 - TVA Multi-taux0%2,1%5,5%10%20% Contractant 10 - TVA - Code2 Multi-taux (Vide)0% 42,1% 35,5% 210% 1120% 10 Contractant 10 - Montant TTC Nombre 2 d\u00e9cimales Contractant 10 - Avance AucuneObligatoireFacultativeA chaque bon de commandeRefus\u00e9e Contractant 10 - Avance - Code Aucune 1Obligatoire 2Facultative 3A chaque bon de commande 4Refus\u00e9e 5 Contractant 10 - Taux d'avance Nombre 2 d\u00e9cimales"},{"location":"SAFI/presentation/","title":"Pr\u00e9sentation","text":""},{"location":"SAFI/presentation/#reprise-des-marches-safi-presentation","title":"Reprise des march\u00e9s SAFI - Pr\u00e9sentation","text":""},{"location":"SAFI/presentation/#gestion-des-donnees","title":"Gestion des donn\u00e9es","text":"<p>Un fichier Excel Online pour favoriser un travail collaboratif entre la DFP et la RPA.</p> <p>Les modifications sont trait\u00e9es en temps r\u00e9el avec les donn\u00e9es \u00e0 jour pour permettre \u00e0 la DFP de mettre \u00e0 jour les valeurs et que la RPA puisse continuer les tests au fur et \u00e0 mesure.</p> <p>Le fichier Excel comporte environ 200 colonnes. Elles sont d\u00e9taill\u00e9es en Annexes</p> <p>Lien vers le fichier Excel</p>"},{"location":"SAFI/presentation/#vision-globale-du-projet","title":"Vision globale du projet","text":"<p>Un diagramme LucidChart est attach\u00e9 au projet et permet de visualiser les diff\u00e9rentes \u00e9tapes.</p> <p>Il permet de confirmer les \u00e9tapes \u00e0 param\u00e9trer pour le robot en envisageant tous les cas possibles \u00e0 traiter.</p> <p>Lien vers le diagramme LucidChart</p>    Votre navigateur ne supporte pas la lecture de vid\u00e9os."},{"location":"SAFI/presentation/#procedure","title":"Proc\u00e9dure","text":"<p>!!! Warning Format date et nombre sur Excel Le format Date sur Excel doit \u00eatre : JJ/MM/AAAA Le s\u00e9parateur de d\u00e9cimales doit \u00eatre un point et non pas une virgule.</p>"},{"location":"SAFI/presentation/#a_initialisation","title":"A_Initialisation","text":"<ul> <li>Fermer les applications ouvertes</li> <li>Lire les donn\u00e9es dans le fichier Excel</li> <li>Se connecter \u00e0 Grand Angle</li> </ul> <p>Ensuite on d\u00e9marre une boucle qui se r\u00e9p\u00e9tera \u00e0 chaque ligne du fichier Excel Tous les contractants sont sur la m\u00eame ligne (jusqu'\u00e0 10 contractants, d'o\u00f9 le nombre important de colonnes)</p>"},{"location":"SAFI/presentation/#b_creationnouveaumarche","title":"B_CreationNouveauMarche","text":"<ul> <li>Cliquer sur cr\u00e9er un nouveau march\u00e9 et remplir les premi\u00e8res informations</li> <li>Ajouter un type d'engagement</li> <li>Remplir la forme, le type de prix et leur date d'\u00e9tablissement</li> <li>Choisir le Code CPV</li> <li>Remplir les Montants</li> <li>Remplir Mode de passation, d\u00e9volution et la gestion de la retenue de garantie</li> <li>D\u00e9finir l'auto-liquidation de la sous-traitance</li> <li>Reconduction</li> <li>D\u00e9finir les dates de consultation, de signature</li> <li>D\u00e9lai de liquidation et fin du flux</li> </ul>"},{"location":"SAFI/presentation/#c_creationcontractant","title":"C_CreationContractant","text":"<ul> <li>Choisir \"Cr\u00e9er un contractant\"</li> <li>Identifier le contractant</li> <li>D\u00e9finir les montants</li> <li>Choisir du m\u00e9canisme d'avance</li> </ul>"},{"location":"SAFI/presentation/#d_formulesactes","title":"D_FormulesActes","text":"<ul> <li>Cr\u00e9er une formule de variation</li> <li>Cr\u00e9er un acte</li> </ul>"},{"location":"SAFI/presentation/#e_rapportexecution","title":"E_RapportExecution","text":"<ul> <li>R\u00e9cup\u00e9rer informations</li> <li>Ecrire informations dans Excel</li> </ul>"},{"location":"SAFI/presentation/#f_finalisation","title":"F_Finalisation","text":"<ul> <li>Fermer applications en cours</li> </ul>"},{"location":"SAFI/presentation/#g_rapporterreur","title":"G_RapportErreur","text":"<ul> <li>R\u00e9cup\u00e9rer informations</li> <li>Ecrire informations dans Excel</li> </ul>"},{"location":"SAFI/presentation/#lancer-lautomatisation","title":"Lancer l'automatisation","text":"<p>Avant de lancer l'automatisation, il faut s'assurer que les donn\u00e9es \u00e0 traiter apparaissent bien dans le fichier \"A traiter\"</p> <p>Pour les faire appara\u00eetre, il faut modifier la feuille \"RPA\" pour que la colonne CD29 comporte la valeur : \"Achev\u00e9\" et que la colonne RPA soit vide.</p> <p>Il faut \u00e9galement que toutes les lignes en dessous du tableau soient vides et sans formatage pour que l'automatisation s'arr\u00eate.</p> <p>!!! Note Dans le pire des cas, le syst\u00e8me retournera une erreur et ne pourra pas cr\u00e9er de nouveau march\u00e9. Les march\u00e9s pr\u00e9c\u00e9dents seront bien cr\u00e9\u00e9s et le rapport d'\u00e9xecution sera \u00e9galement \u00e0 jour. Il suffira de fermer manuellement Excel et Edge.</p> <p>Apr\u00e8s le traitement, les donn\u00e9es sont toujours dans la feuille \"A traiter\".</p> <p>Pour migrer les lignes vers la feuille \"Trait\u00e9\", il suffit de remplir \"Valide\" dans la feuille \"RPA\"</p> <p>!!! Warning Le rapport d'ex\u00e9cution restera dans la feuille \"A traiter\", il faudra reporter ces informations dans la feuille \"Trait\u00e9\" manuellement.</p>"},{"location":"memo-javascript/general/","title":"G\u00e9n\u00e9ral","text":""},{"location":"memo-javascript/general/#memo-javascript-general","title":"M\u00e9mo Javascript - G\u00e9n\u00e9ral","text":""},{"location":"memo-javascript/general/#pointer-sur-un-champ-du-formulaire","title":"Pointer sur un champ du formulaire","text":"<p>Tous les scripts commencent par \"document\", \"document\" correspond au contenu visible de la page.</p>"},{"location":"memo-javascript/general/#getelementbyid","title":".getElementbyId","text":"<p>On peut alors pointer sur un champ du formulaire en le retrouvant gr\u00e2ce \u00e0 son ID unique.</p> <pre><code>document.getElementById(\"test\");\n</code></pre> <p>Toutefois, sur Grand Angle, la majorit\u00e9 des champs du formulaire n'ont pas d'ID renseign\u00e9.</p>"},{"location":"memo-javascript/general/#getelementsbyname","title":".getElementsByName","text":"<p>Sur Grand Angle, la majorit\u00e9 des champs du formulaire ont un \"name\" et pas d'ID. Mais ce \"name\" n'est pas n\u00e9cessairement unique sur la page il peut y avoir plusieurs \u00e9l\u00e9ments avec le m\u00eame \"name\" contrairement \u00e0 l'ID.</p> <pre><code>document.getElementsByName(\"test\");\n</code></pre> <p>Ce code ci-dessus ne pointera pas sur l'\u00e9l\u00e9ment m\u00eame si le nom est utilis\u00e9 une seule fois sur la page. Il pointera vers la liste des \u00e9l\u00e9ments avec ce nom. (M\u00eame si la liste ne comporte qu'un seul \u00e9l\u00e9ment) Il faut donc pointer sur le premier \u00e9l\u00e9ment de la liste : L'\u00e9lement [0] de la liste.</p> <pre><code>document.getElementsByName(\"test\")[0];\n</code></pre> <p>Ce code ci-dessus pointera sur le premier \u00e9l\u00e9ment de la liste et s'il n'y a qu'un seul \u00e9l\u00e9ment sur la page avec ce \"name\" il sera s\u00e9lectionn\u00e9 \u00e9galement.</p> <p>Si l'\u00e9lement n'a ni ID et ni \"name\". Il est possible de pointer par rapport au \"classname\" et au \"tagname\". On les verra sur des cas concrets.</p>"},{"location":"memo-javascript/general/#remplir-le-champ-du-formulaire","title":"Remplir le champ du formulaire","text":""},{"location":"memo-javascript/general/#cliquer-sur-un-bouton","title":"Cliquer sur un bouton","text":"<p>Pour cliquer sur un \u00e9l\u00e9ment, il suffit d'ajouter .click() apr\u00e8s avoir s\u00e9lectionner l'\u00e9l\u00e9ment \u00e0 cliquer.</p> <pre><code>document.getElementsByName(\"test\")[0].click();\n</code></pre> <p>Certains boutons comme \"Page suivante\", \"Valider\", \"Retour\" ou les onglets d\u00e9clenchent uniquement des scripts tr\u00e8s courts qui peuvent \u00eatre repris directement.</p>"},{"location":"memo-javascript/general/#remplir-du-texte-dans-le-champ-du-formulaire","title":"Remplir du texte dans le champ du formulaire","text":"<p>Pour remplir du texte, il suffit de changer la valeur de l'\u00e9l\u00e9ment.</p> <pre><code>document.getElementsbyId('test').value=\"Texte\";\n</code></pre> <p>Warning</p> <p>En remplissant manuellement certaines cases, des scripts se lancent automatiquement parfois. (Notamment sur des montants) G\u00e9n\u00e9ralement on les retrouve dans le param\u00e8tre \"onchange\" de l'\u00e9l\u00e9ment. Lorsque l'on change uniquement la valeur par script, les scripts qui se lan\u00e7aient automatiquement ne se lancent pas. C'est notamment le cas pour tous les montants avec TVA calcul\u00e9e.</p> <p>Il existe deux m\u00e9thodes pour simuler la saisie manuelle :</p> <ol> <li> <p>Reprendre le script avec l'inspecteur</p> </li> <li> <p>Lancer le script avec onchange()</p> </li> </ol> <pre><code>document.getElementsByName(\"test\")[0].onchange();\n</code></pre>"},{"location":"memo-javascript/general/#selectionner-un-element-sans-classname","title":"S\u00e9lectionner un \u00e9l\u00e9ment sans ClassName","text":"<p>On peut chercher avec le TagName : Voir exemple </p><pre><code>document.getElementsByTagName('a')[4].click()\n</code></pre>"},{"location":"memo-javascript/general/#cocher-une-case","title":"Cocher une case","text":"<pre><code>document.test()\n</code></pre>"},{"location":"memo-javascript/general/#choisir-un-element-dans-une-liste-deroulante","title":"Choisir un \u00e9l\u00e9ment dans une liste d\u00e9roulante","text":""},{"location":"memo-javascript/general/#choisir-un-element-dans-une-liste-de-boutons-radio","title":"Choisir un \u00e9l\u00e9ment dans une liste de boutons radio","text":""},{"location":"memo-javascript/grand-angle/","title":"Grand Angle","text":""},{"location":"memo-javascript/grand-angle/#memo-javascript-grand-angle","title":"M\u00e9mo Javascript - Grand Angle","text":"<p>Warning</p> <p>Ces codes fonctionnent dans le cadre de l'automatisation de Reprise des march\u00e9s SAFI, mais il faut quand m\u00eame v\u00e9rifier avec l'inspecteur de Microsoft Edge au cas o\u00f9 Grand Angle effectue une mise \u00e0 jour ou bien si la fonction n'est pas exactement la m\u00eame.</p>"},{"location":"memo-javascript/grand-angle/#enlever-le-bandeau-lors-de-la-connexion","title":"Enlever le bandeau lors de la connexion","text":"<pre><code>// Enlever bandeau\ndocument.cookie = \"rgpdInfosHidden=1; path=/;\";\ndocument.getElementsByClassName(\"mat-snack-bar-container\")[0].style.display = \"none\";\n</code></pre>"},{"location":"memo-javascript/grand-angle/#cliquer-sur-des-boutons","title":"Cliquer sur des boutons","text":""},{"location":"memo-javascript/grand-angle/#passer-a-la-page-suivante","title":"Passer \u00e0 la page suivante","text":"<pre><code>// Page suivante\neffectuerSuivante()\n</code></pre>"},{"location":"memo-javascript/grand-angle/#cliquer-sur-valider","title":"Cliquer sur Valider","text":"<pre><code>Valider()\n</code></pre>"},{"location":"memo-javascript/grand-angle/#cliquer-sur-retour","title":"Cliquer sur Retour","text":"<p>Le bouton retour suit ce format : </p><pre><code>// Cliquer sur Retour \nRetour(00, \"../../intranet/marc/AfficheMarche.gda?cas=4&amp;IDG=1&amp;IDG=1&amp;IDIP=IDIP_1670579254806&amp;code=1052&amp;ignorerIDIP=1&amp;onglet=2&amp;histoaction=-1\")\n</code></pre> Mais, il existe des variantes. Il faut donc utiliser l'inspecteur dans ce cas. <pre><code>// Cliquer sur Retour\nRetour(00, \"../../intranet/marc/AfficheMarche.gda?cas=4&amp;IDG=1&amp;IDG=1&amp;IDIP=IDIP_1670856590548&amp;code=1078&amp;ignorerIDIP=1&amp;onglet=2&amp;histoaction=-1\")\n</code></pre>"},{"location":"memo-javascript/grand-angle/#cliquer-sur-rechercher","title":"Cliquer sur Rechercher","text":"<pre><code>rch_jsp_BoutonRechercher()\n</code></pre>"},{"location":"memo-javascript/grand-angle/#creer-un-nouvel-element","title":"Cr\u00e9er un nouvel \u00e9l\u00e9ment","text":"<pre><code>//Cliquer sur l'onglet d\u00e9tails\nChangerOnglet(2);\n</code></pre> <pre><code>// Cr\u00e9er un contractant\nchargerPage('../../intranet/marc/CreerContractant.gda', event)\n</code></pre> <pre><code>// Cr\u00e9er une formule\nchargerPage('../../intranet/marc/CreerFormuleVariation.gda')\n</code></pre> <pre><code>// Creer un acte\nchargerPage('../../intranet/marc/CreerActe.gda', event);\n</code></pre>"},{"location":"memo-javascript/grand-angle/#cliquer-sur-une-loupe","title":"Cliquer sur une loupe","text":"<p>Voici le format du code. Il faut utiliser l'inspecteur pour r\u00e9cup\u00e9rer le bon code. </p><pre><code>// Cliquer sur la loupe Type d'engagement\nsaisieAssisteeTypeEnga()\n</code></pre> <pre><code>// Cliquer sur la loupe R\u00e9f\u00e9rences Bancaires\nsaisieAssisteeReferenceBancaire('contractantTiers_miCode', 'contracantRefBancaireTiers_miCode', 'contractantRefBancaire_miCode', 'contractantRefBancaire_msLib');\n</code></pre> <p>```</p>"}]}